<!DOCTYPE html>
<html lang="en">

<head>
	<title>SP Travel - Register</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--===============================================================================================-->
	<link rel="icon" type="image/png" sizes="16x16" href="../assets/images/favicon.png">
	<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
	<link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" href="css/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" href="css/bootstrap-datepicker.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/loginutil.css">
	<link rel="stylesheet" type="text/css" href="css/login.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/flaticon.css">
	<link rel="stylesheet" href="css/icomoon.css">
	<!--===============================================================================================-->
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
		<div class="container">
			<a class="navbar-brand" href="/"><span>SP Travel</span></a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
				aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="oi oi-menu"></span> Menu
			</button>

			<div class="collapse navbar-collapse" id="ftco-nav">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item"><a href="/" class="nav-link">Home</a></li>
					<li class="nav-item"><a href="/about" class="nav-link">About</a></li>
					<li class="nav-item"><a href="/destinations" class="nav-link">Destinations</a></li>
					<li class="nav-item"><a href="/contact" class="nav-link">Contact</a></li>
				</ul>
				<ul class="navbar-nav ml-auto">
					<li class="nav-item active cta"><a href="/login" class="nav-link">Login</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="limiter">
		<div class="container-login100">
			<div class="wrap-login100 p-t-50 p-b-90">
				<form class="login100-form validate-form flex-sb flex-w" id="register-form">
					<span class="login100-form-title p-b-51">
						Register
					</span>
                    
                    <div id="msg" class="mb-4"></div>
                    <label for="username">Username:</label>
					<div class="wrap-input100 validate-input m-b-16" data-validate="Username is required">
						<input class="input100" id="username" type="text" name="username" placeholder="Username">
						<span class="focus-input100"></span>
					</div>

                    <label for="email">Email:</label>
					<div class="wrap-input100 validate-input m-b-16" data-validate="Email is required">
						<input class="input100" id="email" type="email" name="email" placeholder="Email">
						<span class="focus-input100"></span>
                    </div>

                    <label for="pass1" class="d-inline">Password:</label>
					<div class="wrap-input100 validate-input m-b-16" data-validate="Password is required">
						<input class="input100" id="password1" type="password" name="pass1" placeholder="•••••••••••">
						<span class="focus-input100"></span>
                    </div>
                    
                    <label for="pass2">Confirm Password:</label>
					<div class="wrap-input100 validate-input m-b-16" data-validate="Password is required">
						<input class="input100" id="password2" type="password" name="pass2" placeholder="•••••••••••">
						<span class="focus-input100"></span>
					</div>

					<div class="container-login100-form-btn m-t-17">
						<button class="login100-form-btn">
							Register
						</button>
					</div>

				</form>
			</div>
		</div>
	</div>


	<div id="dropDownSelect1"></div>
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-migrate-3.0.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery.easing.1.3.js"></script>
	<script src="js/jquery.waypoints.min.js"></script>
	<script src="js/jquery.stellar.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/aos.js"></script>
	<script src="js/jquery.animateNumber.min.js"></script>
	<script src="js/bootstrap-datepicker.js"></script>
	<script src="js/scrollax.min.js"></script>
	<script src="js/main.js"></script>
	<script src="js/loginbutton.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script>
		const baseUrl = "http://localhost:8081";
		$("#register-form").submit((event) => {
			// prevent page reload
			event.preventDefault();

			const username = $("#username").val();
			const email = $("#email").val();
			const password1 = $("#password1").val();
			const password2 = $("#password2").val();

			if (username && email && password1 && password1 === password2) {
				const requestBody = {
					username: username,
					email: email,
					password1: password1,
					password2: password2
				};

				axios.post(`${baseUrl}/users/`, requestBody)
					.then((response) => {
						window.location.href = "/login";
					})
					.catch((error) => {
                        $('#msg').replaceWith(`<div class="wrap-input100 alert alert-warning text-center" role="alert" id="msg">Register failed!</div>`);
                        $('#msg').fadeOut(2400);
                        setTimeout(function () {
                            $('#msg').replaceWith(`<div id="msg"></div>`);
                        }, 2500)
                        console.error(error);
					});
            }
            else if (password1 !== password2) {
                $('#msg').replaceWith(`<div class="wrap-input100 alert alert-warning text-center" role="alert" id="msg">Password are not the same!</div>`);
				$('#msg').fadeOut(2400);
				setTimeout(function () {
					$('#msg').replaceWith(`<div id="msg"></div>`);
				}, 2500)
            }
			else {
				$('#msg').replaceWith(`<div class="wrap-input100 alert alert-warning text-center" role="alert" id="msg">Fill in all the required fields!</div>`);
				$('#msg').fadeOut(2400);
				setTimeout(function () {
					$('#msg').replaceWith(`<div id="msg"></div>`);
				}, 2500)
			}
		});

	</script>

</body>

</html>